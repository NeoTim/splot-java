<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Keychain - [DRAFT] Splot Design Documentation</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="affix"><a href="../title-page.html">Splot Design Documentation</a></li><li><a href="../intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li><a href="../design-goals.html"><strong aria-hidden="true">1.1.</strong> Design Goals</a></li><li><a href="../terminology.html"><strong aria-hidden="true">1.2.</strong> Terminology</a></li></ol></li><li><a href="../som/intro.html"><strong aria-hidden="true">2.</strong> Splot Object Model</a></li><li><ol class="section"><li><a href="../som/arch.html"><strong aria-hidden="true">2.1.</strong> Architecture</a></li><li><a href="../som/things.html"><strong aria-hidden="true">2.2.</strong> Things</a></li><li><a href="../som/properties.html"><strong aria-hidden="true">2.3.</strong> Properties</a></li><li><a href="../som/methods.html"><strong aria-hidden="true">2.4.</strong> Methods</a></li><li><a href="../som/traits.html"><strong aria-hidden="true">2.5.</strong> Traits</a></li><li><a href="../som/children.html"><strong aria-hidden="true">2.6.</strong> Children</a></li><li><a href="../som/trait-profiles.html"><strong aria-hidden="true">2.7.</strong> Trait Profiles</a></li><li><a href="../som/groups.html"><strong aria-hidden="true">2.8.</strong> Groups</a></li><li><a href="../som/technologies.html"><strong aria-hidden="true">2.9.</strong> Technologies</a></li></ol></li><li><a href="../automation/intro.html"><strong aria-hidden="true">3.</strong> Automation</a></li><li><ol class="section"><li><a href="../automation/primitives.html"><strong aria-hidden="true">3.1.</strong> Primitives</a></li><li><ol class="section"><li><a href="../automation/pairings.html"><strong aria-hidden="true">3.1.1.</strong> Pairings</a></li><li><a href="../automation/rules.html"><strong aria-hidden="true">3.1.2.</strong> Rules</a></li><li><a href="../automation/timers.html"><strong aria-hidden="true">3.1.3.</strong> Timers</a></li><li><a href="../automation/actionable.html"><strong aria-hidden="true">3.1.4.</strong> Actionable Primitives</a></li></ol></li><li><a href="../automation/expressions.html"><strong aria-hidden="true">3.2.</strong> Automation Expressions</a></li><li><a href="../automation/recipes.html"><strong aria-hidden="true">3.3.</strong> Automation Recipes</a></li><li><a href="../automation/examples.html"><strong aria-hidden="true">3.4.</strong> Pulling it All Together</a></li></ol></li><li><a href="../ssm/intro.html"><strong aria-hidden="true">4.</strong> Splot Security Model</a></li><li><ol class="section"><li><a href="../ssm/arch.html"><strong aria-hidden="true">4.1.</strong> Architecture</a></li><li><a href="../ssm/sessions.html"><strong aria-hidden="true">4.2.</strong> Security Sessions</a></li><li><a href="../ssm/identities.html"><strong aria-hidden="true">4.3.</strong> Identities</a></li><li><a href="../ssm/keychain.html" class="active"><strong aria-hidden="true">4.4.</strong> Keychain</a></li><li><a href="../ssm/lost-secret-recovery.html"><strong aria-hidden="true">4.5.</strong> Lost Secret Recovery</a></li><li><a href="../ssm/spske.html"><strong aria-hidden="true">4.6.</strong> Single-Purpose Shared Key Establishment</a></li><li><a href="../ssm/unresolved-issues.html"><strong aria-hidden="true">4.7.</strong> Unresolved Issues</a></li></ol></li><li><a href="../smcp/intro.html"><strong aria-hidden="true">5.</strong> Splot Monitoring and Control Protocol</a></li><li><ol class="section"><li><a href="../smcp/examples.html"><strong aria-hidden="true">5.1.</strong> Introductory Example</a></li><li><a href="../smcp/cloud_control.html"><strong aria-hidden="true">5.2.</strong> Remote Monitoring and Control</a></li></ol></li><li><a href="../trait-def/core/intro.html"><strong aria-hidden="true">6.</strong> Core Traits</a></li><li><ol class="section"><li><a href="../trait-def/core/base.html"><strong aria-hidden="true">6.1.</strong> Base</a></li><li><a href="../trait-def/core/group.html"><strong aria-hidden="true">6.2.</strong> Group</a></li><li><a href="../trait-def/core/scene.html"><strong aria-hidden="true">6.3.</strong> Scene</a></li><li><a href="../trait-def/core/transition.html"><strong aria-hidden="true">6.4.</strong> Transition</a></li></ol></li><li><a href="../trait-def/std/intro.html"><strong aria-hidden="true">7.</strong> Standard Traits</a></li><li><ol class="section"><li><a href="../trait-def/std/on-off.html"><strong aria-hidden="true">7.1.</strong> OnOff</a></li><li><a href="../trait-def/std/level.html"><strong aria-hidden="true">7.2.</strong> Level</a></li><li><a href="../trait-def/std/light.html"><strong aria-hidden="true">7.3.</strong> Light</a></li><li><a href="../trait-def/std/enabled.html"><strong aria-hidden="true">7.4.</strong> Enabled</a></li><li><a href="../trait-def/std/energy.html"><strong aria-hidden="true">7.5.</strong> Energy</a></li><li><a href="../trait-def/std/battery.html"><strong aria-hidden="true">7.6.</strong> Battery</a></li><li><a href="../trait-def/std/ambient-environment.html"><strong aria-hidden="true">7.7.</strong> AmbientEnvironment</a></li><li><a href="../trait-def/std/button.html"><strong aria-hidden="true">7.8.</strong> Button</a></li><li><a href="../trait-def/std/presence.html"><strong aria-hidden="true">7.9.</strong> Presence</a></li></ol></li><li><a href="../trait-def/auto/intro.html"><strong aria-hidden="true">8.</strong> Automation Traits</a></li><li><ol class="section"><li><a href="../trait-def/auto/pairing.html"><strong aria-hidden="true">8.1.</strong> Pairing</a></li><li><a href="../trait-def/auto/pairing-manager.html"><strong aria-hidden="true">8.2.</strong> PairingManager</a></li><li><a href="../trait-def/auto/actionable.html"><strong aria-hidden="true">8.3.</strong> Actionable</a></li><li><a href="../trait-def/auto/rule.html"><strong aria-hidden="true">8.4.</strong> Rule</a></li><li><a href="../trait-def/auto/rule-manager.html"><strong aria-hidden="true">8.5.</strong> RuleManager</a></li><li><a href="../trait-def/auto/timer.html"><strong aria-hidden="true">8.6.</strong> Timer</a></li><li><a href="../trait-def/auto/timer-manager.html"><strong aria-hidden="true">8.7.</strong> TimerManager</a></li></ol></li><li><a href="../trait-def/sec/intro.html"><strong aria-hidden="true">9.</strong> Security Traits</a></li><li><ol class="section"><li><a href="../trait-def/sec/keychain.html"><strong aria-hidden="true">9.1.</strong> Keychain</a></li><li><a href="../trait-def/sec/keychain-item.html"><strong aria-hidden="true">9.2.</strong> KeychainItem</a></li><li><a href="../trait-def/sec/identity.html"><strong aria-hidden="true">9.3.</strong> Identity</a></li><li><a href="../trait-def/sec/access-rule.html"><strong aria-hidden="true">9.4.</strong> AccessRule</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">[DRAFT] Splot Design Documentation</h1>

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#keychain" id="keychain">Keychain</a></h1>
<p>The keychain is the manager of cryptographic secrets and certificates,
referred to as <em>keychain items</em>.</p>
<h2><a class="header" href="#keychain-items" id="keychain-items">Keychain Items</a></h2>
<p>A <em>keychain item</em> can be either a <em>shared secret</em>,
<em>password</em>, or <em>certificate</em> (with or without a private key).
Conceptually, keychain items are used to authenticate devices to each
other, and in practice may also be simultaneously used for
establishing cryptographic session keys.</p>
<p>All keychain items have at least the following attributes:</p>
<ul>
<li>Identifier used to identify the item during establishment of the
<em>security session</em>.</li>
<li>Human-readable Administrative label</li>
<li>Object type (Shared Secret, Password, or Certificate)</li>
<li>Associated local <em>identity</em> (Default: &quot;anon&quot;)</li>
<li>A flag indicating if the keychain item is enabled.</li>
<li>A flag indicating if the keychain item is permanent.</li>
<li><em>Lost secret recovery share</em></li>
</ul>
<p>Ideally, the private/secret part of each keychain item would be stored
in a secure element (&quot;hardware backed&quot;).</p>
<h3><a class="header" href="#shared-secrets" id="shared-secrets">Shared Secrets</a></h3>
<p><em>Shared Secrets</em> allow for mutual authentication of client and
server. They are <em>high-entropy</em> and can be used directly in the
calculation of a shared session key. These are typically used to
secure device-to-device relationships and are associated with
identities which are very limited in scope.</p>
<h3><a class="header" href="#passwords" id="passwords">Passwords</a></h3>
<p><em>Passwords</em> also allow for mutual authentication of client and
server. They are <em>low-entropy</em>, so they must be used with a PAKE
algorithm to establish a strong shared session key. These items are
generally only used for initial device configuration, but the security
model defines them as a top-level keychain item type. From a
high-level perspective, they behave identically to <em>shared
secrets</em>.</p>
<h3><a class="header" href="#certificates" id="certificates">Certificates</a></h3>
<p><em>Certificates</em> allow for one-way authentication between a server
and a client. The exact implementation details are TBD, but they are
expected to be based on X.509. Certificates are generally used for
direct administration rather than for automation.</p>
<p>Conceptually, there are two types of certificate keychain items: those
with private keys and those without. A <em>certificate with a private
key</em> allows the device to authenticate itself to other devices. It
is not used to authenticate other devices, and thus these keychain
items are not typically associated with an identity other than &quot;anon&quot;.</p>
<p>A <em>certificate without a private key</em> only allows the device to
authenticate other devices that have a private key with this
certificate or one signed by it.</p>
<p>For example, the administrator device (smart phone) has a self-signed
admin certificate for devices in its domain. The administrator would
install this admin certificate (without a private key) onto a managed
device at commissioning and associate it with the &quot;admin&quot; identity.
The administrator device can then be used to securely manage any
devices configured in this way.</p>
<h2><a class="header" href="#permanent-keychain-items" id="permanent-keychain-items">Permanent Keychain Items</a></h2>
<p>There are currently three types of &quot;permanent&quot; keychain items that are
used for device identification and initial commissioning:</p>
<h3><a class="header" href="#self-signed-certificate--private-key" id="self-signed-certificate--private-key">Self-signed Certificate + Private Key</a></h3>
<p>The only purpose of this keychain item is to uniquely identify the
device. It is recalculated at factory reset to ensure privacy. This
certificate is used by a server when the client wants to use a client
certificate and doesn’t specify a key identifier for the server.
This keychain item has an identifier of &quot;self&quot; if direct selection is
desired.</p>
<h3><a class="header" href="#attestation-certificate--private-key" id="attestation-certificate--private-key">Attestation Certificate + Private Key</a></h3>
<p>This certificate is anonymized using batch keys, similar to FIDO
tokens. It is not associated with an identity: It is used for
additional attestation (for things like certification requirements) of
an already established security session. The keychain identity of
attestation certificates is largely defined by the manufacturer, but
the following values are recommended:</p>
<ul>
<li>
<p>&quot;mfgr&quot; for manufacturer attestation</p>
</li>
<li>
<p>&quot;ecos&quot; for ecosystem attestation</p>
</li>
<li>
<p>&quot;reg&quot; for regulatory attestation</p>
</li>
</ul>
<h3><a class="header" href="#device-setup-codepassword" id="device-setup-codepassword">Device Setup Code/Password</a></h3>
<p>Security sessions created using this keychain item are always
associated with the &quot;init&quot; identity. It shall only be used when
physical proximity can be assured. This keychain item has an
identifier of “init”. The value for this secret may be permanent
(read off of a label on the device) or calculated dynamically
(displayed after pressing a button).</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../ssm/identities.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../ssm/lost-secret-recovery.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../ssm/identities.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../ssm/lost-secret-recovery.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
